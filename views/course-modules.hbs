{{!-- course-modules.hbs - Course modules list page --}}

<div class="course-modules">
  {{#if error}}
    <div class="alert alert-error">
      <strong>Error:</strong> {{error}}
    </div>
  {{/if}}

  {{#if course}}
    <div class="course-header">
      <h1>{{course.title}}</h1>
      <p class="course-instructor">by {{course.instructor}}</p>
      
      {{#if progress}}
        <div class="progress-container">
          <div class="progress-info">
            <span>Progress: {{progress.completed}}/{{progress.total}} modules completed</span>
            <span class="progress-percentage">{{progress.percentage}}%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: {{progress.percentage}}%"></div>
          </div>
          {{#if progress.certificate_url}}
            <a href="{{progress.certificate_url}}" class="certificate-link" target="_blank">
              üèÜ Download Certificate
            </a>
          {{/if}}
        </div>
      {{/if}}
    </div>

    {{#if modules}}
      <div class="modules-list">
        {{#each modules}}
          <div class="module-card {{#if this.is_completed}}completed{{/if}}">
            <div class="module-header">
              <div class="module-info">
                <h3>{{this.order}}. {{this.title}}</h3>
                <p class="module-description">{{this.description}}</p>
              </div>
              <div class="module-status">
                {{#if this.is_completed}}
                  <span class="status-badge completed">‚úÖ Completed</span>
                {{else}}
                  <span class="status-badge pending">‚è≥ Not Started</span>
                {{/if}}
              </div>
            </div>
            
            <div class="module-content">
              {{#if this.pdf_content}}
                <div class="content-item">
                  <span class="content-icon">üìÑ</span>
                  <span>PDF Material Available</span>
                </div>
              {{/if}}
              
              {{#if this.video_content}}
                <div class="content-item">
                  <span class="content-icon">üé•</span>
                  <span>Video Content Available</span>
                </div>
              {{/if}}
            </div>
            
            <div class="module-actions">
              <a href="/modules/{{this.id}}" class="btn btn-primary">
                {{#if this.is_completed}}
                  üìñ Review Module
                {{else}}
                  üöÄ Start Module
                {{/if}}
              </a>
            </div>
          </div>
        {{/each}}
      </div>

      {{#if pagination}}
            {{#if (gt totalPages 1)}}
      <div class="pagination">
        {{#if (gt currentPageNum 1)}}
          <a href="?page={{subtract currentPageNum 1}}" class="pagination-btn">
            ‚Üê Previous
          </a>
        {{/if}}

        {{#each (range 1 totalPages)}}
          {{#if (eq this ../currentPageNum)}}
            <span class="pagination-btn active">{{this}}</span>
          {{else}}
            <a href="?page={{this}}" class="pagination-btn">{{this}}</a>
          {{/if}}
        {{/each}}

        {{#if (lt currentPageNum totalPages)}}
          <a href="?page={{add currentPageNum 1}}" class="pagination-btn">
            Next ‚Üí
          </a>
        {{/if}}
      </div>
    {{/if}}
      {{/if}}
    {{else}}
      <div class="empty-state">
        <h3>No modules available</h3>
        <p>This course doesn't have any modules yet.</p>
        <a href="/my-courses" class="btn btn-primary">Back to My Courses</a>
      </div>
    {{/if}}
  {{/if}}
</div>

<style>
  .course-modules {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
  }

  .course-header {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #e2e8f0;
  }

  .course-header h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    color: #2d3748;
  }

  .course-instructor {
    color: #4c51bf;
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .progress-container {
    background: #f7fafc;
    padding: 1.5rem;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
  }

  .progress-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #4a5568;
  }

  .progress-percentage {
    color: #4c51bf;
    font-size: 1.1rem;
  }

  .progress-bar {
    width: 100%;
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4c51bf, #667eea);
    transition: width 0.3s ease;
  }

  .certificate-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: #d69e2e;
    font-weight: 600;
    text-decoration: none;
    padding: 0.5rem 1rem;
    background: #fffbeb;
    border: 1px solid #f6e05e;
    border-radius: 4px;
    transition: all 0.2s;
  }

  .certificate-link:hover {
    background: #fef5e7;
    color: #c69026;
  }

  .modules-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .module-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1.5rem;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .module-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .module-card.completed {
    border-color: #68d391;
    background: linear-gradient(135deg, #f0fff4 0%, #ffffff 100%);
  }

  .module-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
  }

  .module-info h3 {
    margin: 0 0 0.5rem 0;
    color: #2d3748;
    font-size: 1.25rem;
  }

  .module-description {
    margin: 0;
    color: #4a5568;
    line-height: 1.5;
  }

  .status-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .status-badge.completed {
    background: #c6f6d5;
    color: #22543d;
  }

  .status-badge.pending {
    background: #feebc8;
    color: #c05621;
  }

  .module-content {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .content-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #4a5568;
    font-size: 0.9rem;
  }

  .content-icon {
    font-size: 1rem;
  }

  .module-actions {
    display: flex;
    justify-content: flex-end;
  }

  .btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.2s;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-primary {
    background: #4c51bf;
    color: white;
  }

  .btn-primary:hover {
    background: #434190;
    color: white;
  }

  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-top: 2rem;
    padding: 1rem;
  }

  .pagination-btn {
    padding: 0.5rem 1rem;
    background: #4c51bf;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    font-weight: 500;
    transition: background-color 0.2s;
  }

  .pagination-btn:hover {
    background: #434190;
    color: white;
  }

  .pagination-info {
    color: #4a5568;
    font-weight: 500;
  }

  .alert {
    padding: 1rem;
    border-radius: 4px;
    margin-bottom: 1rem;
  }

  .alert-error {
    background: #fed7d7;
    color: #9b2c2c;
    border: 1px solid #feb2b2;
  }

  .empty-state {
    text-align: center;
    padding: 3rem;
    color: #718096;
  }

  .empty-state h3 {
    margin: 0 0 0.5rem 0;
    color: #4a5568;
  }

  @media (max-width: 768px) {
    .course-modules {
      padding: 1rem;
    }
    
    .module-header {
      flex-direction: column;
      gap: 1rem;
    }
    
    .progress-info {
      flex-direction: column;
      gap: 0.5rem;
      align-items: flex-start;
    }
  }
</style>
